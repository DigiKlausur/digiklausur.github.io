<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>E2x JupyterHub &mdash; E2X H-BRS</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Environment" href="environment.html" />
    <link rel="prev" title="Instructors" href="../usage/instructor.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            E2X H-BRS
              <img src="../_static/e2x.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../research.html">Research</a></li>
<li class="toctree-l1"><a class="reference internal" href="../talks.html">Talks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../people.html">People</a></li>
<li class="toctree-l1"><a class="reference internal" href="../incident-reports.html">Incident Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../news.html">News</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/student.html">Students</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/instructor.html">Instructors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">JupyterHub</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">E2x JupyterHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment.html">Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic-config.html">Dynamic Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">E2xgrader</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../e2xgrader/e2xgrader.html">E2xgrader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../e2xgrader/installation.html">E2xgrader Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../e2xgrader/configuration.html">E2xgrader Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Nbassignment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../nbassignment/nbassignment.html">Nbassignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nbassignment/installation.html">Nbassignment Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ExamKernel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../exam_kernel/exam_kernel.html">Exam Kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exam_kernel/installation.html">ExamKernel Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exam_kernel/configuration.html">ExamKernel Configuration</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">E2X H-BRS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">E2x JupyterHub</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="e2x-jupyterhub">
<span id="id1"></span><h1>E2x JupyterHub<a class="headerlink" href="#e2x-jupyterhub" title="Permalink to this heading"></a></h1>
<p>JupyterHub is a multi user hub that spawns, manages, and proxies multiple
Jupyter Notebook servers. We use JupyterHub for some
<a class="reference external" href="https://www.h-brs.de/en/inf/study/master/autonomous-systems">Master Autonomous Systems</a>,
<a class="reference external" href="https://www.h-brs.de/de/inf/studienangebot/master/informatik">Master Informatik</a>,
and <a class="reference external" href="https://www.h-brs.de/de/inf/studienangebot/bachelor/informatik">Bachelor Informatik</a>
courses for both teaching and examination.</p>
<p>We deploy JupyterHub on Kubernetes cluster using using
<a class="reference external" href="https://zero-to-jupyterhub.readthedocs.io">Zero-to-JupyterHub</a> which provides
a nice, step-by-step tutorial on how to install JupyterHub on Kubernetes on
different cloud providers. Our Kubernetes (k8s) cluster is provisioned on FB02 OpenStack
using <a class="reference external" href="https://github.com/kubernetes-sigs/kubespray">Kubespray</a>.</p>
<p>There are three servers running on e2x Kubernetes cluster:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://e2x.inf.h-brs.de/jupyteSrhub/uebung">Assignment server</a></p></li>
</ol>
<blockquote>
<div><p>The assignment server is used by graders and students for teaching purposes.
The usage guidelines can be found in <a class="reference internal" href="../usage/student.html#usage-student"><span class="std std-ref">student’s guidelines</span></a> and
<a class="reference internal" href="../usage/instructor.html#usage-instructor"><span class="std std-ref">grader’s guidelines</span></a> for students and graders
respectively.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p><a class="reference external" href="https://e2x.inf.h-brs.de/jupyterhub/klausur">Exam server</a></p></li>
</ol>
<blockquote>
<div><p>The exam server is used by students during exams. The server is only accessible
from pool rooms, laptop pool and staff vpn. One time password is used as
the JupyterHub authentication. The <a class="reference external" href="https://github.com/DigiKlausur/docker-stacks/tree/master/exam-notebook">environment for exam</a>
is restricted using <a class="reference external" href="https://github.com/DigiKlausur/e2xgrader">e2x view extension</a>.
Internal and external network communications are also blocked using Kubernetes
<a class="reference external" href="https://kubernetes.io/docs/concepts/services-networking/network-policies/">Network Policy</a>.
For the sake of the originality of student’s work, the submissions are always hashed
to make sure that they have not been tempered with.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>During Covid-19 pandemic, the exam server is open to public during examination period,
since the exams are conducted at home.</p>
</div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p><a class="reference external" href="https://e2x.inf.h-brs.de/jupyterhub/klausur">Exam grading server</a></p></li>
</ol>
<blockquote>
<div><p>The grading server is used by graders for grading exam submissions.
The server uses LDAP authentication. The guidelines for the graders
can be found <a class="reference internal" href="../usage/instructor.html#usage-instructor"><span class="std std-ref">here</span></a>.</p>
</div></blockquote>
<p>The whole system architecture is illustrated in the following figure:</p>
<img alt="../_images/e2x-infra-k8s-openstack.png" class="align-center" src="../_images/e2x-infra-k8s-openstack.png" />
<ul class="simple">
<li><p><strong>Kubernetes cluster</strong>: e2x k8s cluster is an hihgly available (HA) cluster
running 3 etcd nodes and 2 master nodes. This would ensure the cluster
running if one etcd node is down.</p></li>
<li><p><strong>Nodes</strong>: 1) Master nodes are dedicated nodes for apiserver, controller manager,
scheduler and etcd; 2) Worker nodes are used for JupyterHub server, assignment
user, and exam user container.</p></li>
<li><p><strong>JupyterHub servers</strong>: the hub servers are deployed using Z2JH and are separated
by a namespace on the cluster. Each server runs in its own container. We heavily
customized <cite>jupyterhub_config</cite> in order to meet the requirements we need.
Z2JH provides an extra config that we use to modify spawner. Our extra config
can be found <a class="reference external" href="https://github.com/DigiKlausur/e2x-jupyterhub/tree/master/kubernetes/jupyterhub">here</a>.</p></li>
<li><p><strong>Spawner</strong>: utilizes <a class="reference external" href="https://github.com/jupyterhub/kubespawner">kubespawner</a>,
which enables JupyterHub to spawn a single user notebook on the worker nodes.
Kubespawner spawns multiple single user notebook server with JupyterHub without
requiring an extra layer such as ansible. Resource allocation, persistent
volume mount (with NFS), security policy setting can also be done easily with kubespawner.
We also modify the spawner in such a way that it can mount the corresponding
user home directory, exchange and other personalized shared directories.
The user information is stored in DB, which is nothing but a csv file containing
the user information such as courses. With this information, we also generate
a personalized profile list for each student, a profile which contains the
courses he/she is registered to, resource allocation, image and personalized
volume mount.</p></li>
<li><p><strong>User’s notebook server</strong>: runs in its own container. Kubernetes provides an isolation
of the user container among other user containers in the same namespace or
different namespace. The specification of the container is generated by the spawner.</p></li>
<li><p><strong>NFS server</strong>: runs on a separate instance on OpenStack. It is used to host
and share <cite>db and home, exchange and shared directories</cite>.</p></li>
<li><p><strong>Load balancer</strong>: Since the OpenStack does not have a load balancer service,
we runs on a separate instance on OpenStack. One way to access the k8s cluster is
to expose JupyterHub service via <a class="reference external" href="https://kubernetes.io/docs/concepts/services-networking/service/">NodePort</a>.
With NodePort it will open the specified port on all k8s nodes. However, since
the k8s nodes are only accessible within the cluster nodes and staff vpn,
a load balancer has to be deployed and users can get access to the cluster via
the load balancer.</p></li>
</ul>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../usage/instructor.html" class="btn btn-neutral float-left" title="Instructors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="environment.html" class="btn btn-neutral float-right" title="Environment" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, E2X H-BRS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>